---
title: "Time-Series Forecasting"
author: Laxmikant 
description: "Time-Series data analysis"
slug: Time-Series data analysis
date: 2018-09-05
lastmod: 2018-09-05
categories: ["blogdown"]
tags: ["Gold","Prophet","Time series"]
summary: Time-Series data analysis
subtitle: Time-Series data analysis
lua:
  image:
    url: "/img/cover.png"
    width: 800
    height: 600
  author: "Laxmikant"
  output:
  html_document:
    df_print: kable
    toc: true
---

<!--more-->


```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```


## What is time series? 

A time series is a sequence of observations collected at some time intervals. 
Time plays an important role here. The observations collected are dependent on the time at which it is collected.
The sale of an item say Turkey wings in a retail store like Walmart will be a time series. 
The sale could be at daily level or weekly level. 
The number of people flying from Bangalore to Kolkata on daily basis is a time series. 
Time is important here. During Durga Puja holidays, this number would be humongous compared to the other days. This is know as seasonality.

Time-series forecasting uses historical time basesd data to forecast a variable for example 

*   The demand for a grocery product at a supermarket each day
*   The number of downloads of an app in a country for the next month
*   Product sales in units sold each day in a retail store
*   Yearly unemployment rate
*   The closing price of a stock
*   Expected yearly yield of a crop
*   Population growth in a country
*   Daily demand for a bus/airline/train


### What is the difference between a time series and a normal series?
Time component is important here. The time series is dependent on the time. However a normal series say 1, 2, 3...100 has no time component to it. 
When the value that a series will take depends on the time it was recorded, it is a time series.

### How to define a time series object in R

ts() function is used for equally spaced time series data, it can be at any level. Daily, weekly, monthly, quarterly, yearly or even at minutes level. 
If you wish to use unequally spaced observations then you will have to use other packages. ts() is used for numerical observations and you can set frequency of the data. ts() takes a single frequency argument. 

### Frequency

When setting the frequency, many people are confused what should be the correct value. This is the simple definition of frequency. Frequency is the number of observations per cycle. Now, how you define what a cycle is for a time series?

Say, you have electricity consumption of Bangalore at hourly level. The cycle could be a day, a week or even annual. I will cover what frequency would be for all different type of time series.

Before we proceed I will reiterate this.

> Frequency is the number of observations per cycle.

  
We will see what values frequency takes for different interval time series.  

**Daily data** There could be a weekly cycle or annual cycle. So the frequency could be 7 or 365.25.

Some of the years have 366 days (leap years). So if your time series data has longer periods, it is better to use frequency = 365.25. This takes care of the leap year as well which may come in your data.

**Weekly data** There could be an annual cycle. frequency = 52 and if you want to take care of leap years then use frequency = 365.25/7

**Monthly data** Cycle is of one year. So frequency = 12

**Quarterly data** Again cycle is of one year. So frequency = 4

**Yearly data** Frequency = 1


### Some useful softwares

1.  forecast: For forecasting functions
    
2.  tseries: For unit root tests and GARC models
    
3.  Mcomp: Time series data from forecasting competitions
    
4.  fma: For data
    
5.  expsmooth: For data
    
6.  fpp: For data

7.  ARIMA

8.  prophet

9.  SPSS
    

**Now, let’s understand prophet**


The idea behind Prophet is quite simple. It represents a **time-series as a combination of trend, seasonality and holidays**. Patterns are represented at different scales — daily, weekly, seasonally, and yearly — along with an overall trend. For example, even though the usage of bikes is higher during summer, there exists an overall trend based on the population size of the city. This decomposable time series model can be represented by the following equation:

![Capture10](/img/ts.png)

where:

*   **g(t)** is the trend function which models non-periodic changes in the time series
*   **s(t)** represents periodic changes (e.g., weekly and yearly seasonality)
*   **h(t)** represents the effects of holidays
*   **εt**: the error term represents information that was missed by the model

### Trend

Prophet provides two variants for the trend function, g(t) which are logistic growth modeling non-linear growth and constant rate of growth or Piecewise Linear Model.

### Seasonality

The seasonal component, _s(t)_ allows to flexibly model **periodic changes due to weekly and yearly seasonality**. For instance, a 5-day work week can produce effects on a time series that repeat each week, while vacation schedules and school breaks can produce effects that repeat each year. Prophet models these periodic effects using Fourier series.

### Holidays and Events

Holidays and events provide large but **predictable shocks** to many business time series and often do not follow a periodic pattern, so their effects are not well modeled by a smooth cycle. For instance, many countries around the world have major holidays that follow the lunar calendar. The impact of a particular holiday is often similar year after year, and it is important to incorporate it into the forecast. Another example would be that of Black Fridays. So if you have holidays or other recurring events that you’d like to model, Prophet allows you to provide a custom list of past and future events.

For those interested in understanding the complete behind-the-scenes of Prophet, you can read to the original paper [“Forecasting at scale”](https://peerj.com/preprints/3190/).


**Now, let’s implement prophet in R**

#### Implementing prophent in R

```{r load-all-libraries}
library(Quandl)
library(quantmod)
library(prophet)

Quandl.api_key("YBM9uPgpnsaDYPkAn539")

daily_gold = Quandl("WGC/GOLD_DAILY_INR",collapse="daily",start_date="2000-01-01",end_date = "2019-10-19",type="raw")

names(daily_gold) <- c('ds','y')

daily_gold[2] <- daily_gold[2] / 28

model = prophet(daily_gold)

future <- make_future_dataframe(model, periods = 10)


forecast <- predict(model, future)


plot(model,forecast)

prophet_plot_components(model,forecast)

```


#### Summary

The main aim of time-series modeling is to carefully collect 
and regorously study the past observations of the time-series to develop an appropriate model which describes the inherent structure of the series. 
The model is then used to generate the future values for the series. 
Time series forecasting is thus can be termed as act of predicting the future by understanding the past. 
