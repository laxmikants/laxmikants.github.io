<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
  <style>

    .nocopy {
      -webkit-user-select: none;   
      -moz-user-select: none;      
      -ms-user-select: none;       
      user-select: none;           
    }  

</style>

<script data-ad-client="ca-pub-3804322353139756" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script async src = "https://www.googletagmanager.com/gtag/js?id=UA-155379268-1"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js',new Date());
 
 gtag('config','UA-155379268-1');

</script>  
  <meta charset="utf-8">
<title>Student Grade Prediction - Data Science Posts and Resources :: Laxmikant Soni</title>

<meta name="viewport" content="width=device-width" />

<meta name="google-site-verification" content="MeRcFEBEyWiTb3NfY4THWxbV_fx3rKOJnvr_Jk398wY" />

<meta name=keywords content="Articles and Posts on Python, R, Data Science, Machine Learning and Analytics | Laxmikant Soni, Predictive Analytics, Business, Data, Analytics, Machine Learning, Mining, Python, Intelligence, Big, Modeling, Data Science, Integration, Visualization,Statistical population,Probability,False positives,Statistical inference,Regression,Fitting,Categorical data,Classification,Clustering,Statistical comparison,CodingDistributions,Data mining,Decision trees,Machine learning,Munging and wrangling,Visualization,D3,Regularization,Assessment,Cross-validation,Neural networks,Boosting,Lift,Mode,Outlier,Predictive modeling,Big data,Confidence interval,Python,R,Jupyter Notebook,Tensorflow,Javascript,ReactJS,NodeJS,Posts and Resources on Data Science,Data Science,Hadoop,Java,Spring,Hibernate,Struts,MySQL,Oracle,DB2,Websphere,Weblogic">

<meta name=description content="Articles and Posts on Python, R, Data Science, Machine Learning and Analytics :: Laxmikant Soni">

<meta name="robots" content="index">


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>




<meta name="generator" content="Hugo 0.80.0" /><meta itemprop="name" content="Student Grade Prediction">
<meta itemprop="description" content="Predicting student grade using Linear Regression">
<meta itemprop="datePublished" content="2020-03-15T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-03-15T00:00:00+00:00" />
<meta itemprop="wordCount" content="1163">



<meta itemprop="keywords" content="Linear Regression," />
<meta property="og:title" content="Student Grade Prediction" />
<meta property="og:description" content="Predicting student grade using Linear Regression" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://laxmikants.github.io/blog/student-grade-prediction/" />
<meta property="article:published_time" content="2020-03-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-03-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Student Grade Prediction"/>
<meta name="twitter:description" content="Predicting student grade using Linear Regression"/>
<meta name="twitter:site" content="@laxmikantsoni09"/>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/monokai.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css">
        <script src="https://kit.fontawesome.com/be54eb011a.js" crossorigin="anonymous"></script>
      <script async   src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="/css/main.min.aa4e8165f5b2a16460fcb21582ad412bed8e48e9c5dc49f3b412d1703be4d75d.css" integrity="sha256-qk6BZfWyoWRg/LIVgq1BK&#43;2OSOnF3EnztBLRcDvk110="><link rel="stylesheet" href="/css/add-on.css">
        <link rel="stylesheet" href="/css/main.css">

<title>Student Grade Prediction : Data Science Posts and Resources</title>

<meta property="og:title" content="Student Grade Prediction">
<meta property="og:site_name" content="Data Science Posts and Resources">
<meta property="og:url" content="https://laxmikants.github.io/blog/student-grade-prediction/">
<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:description" content="Predicting student grade using Linear Regression">
<meta name="description" content="Predicting student grade using Linear Regression">
<meta property="og:updated_time" content="2020-03-15T00:00:00Z">
<meta property="fb:app_id" content="428818034507005">
<meta name="author" content="Laxmikant Soni">

<meta property="article:author" content="https://laxmikants.github.io">
<meta property="article:published_time" content="2020-03-15T00:00:00Z">
<meta property="article:modified_time" content="2020-03-15T00:00:00Z">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "Student Grade Prediction",
  "alternativeHeadline": "Student Grade Prediction with Linear Regression",
  "name" : "Data Science Posts and Resources",
  "url": "https://laxmikants.github.io/blog/student-grade-prediction/",
  "image": "https://laxmikants.github.io/",
  "sameAs":
      [ "https://www.facebook.com/laxmikantsoni09",
        "https://instagram.com/laxmikantsoni09",
        "https://www.linkedin.com/in/laxmikantsoni09",
        "https://twitter.com/laxmikantsoni09",
        "https://github.com/laxmikants",
        "https://www.kaggle.com/laxmikantsoni"
    ],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://laxmikants.github.io/blog/student-grade-prediction/"
  },
  "description": "Predicting student grade using Linear Regression",
  "author": {
    "@type": "Person",
    "name": "Laxmikant Soni"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data Science Posts and Resources",
    "logo": {
      "@type": "ImageObject",
      "url": "https://laxmikants.github.io/"
    }
  },
  "datePublished": "2020-03-15T00:00:00Z",
  "dateModified": "2020-03-15T00:00:00Z",
  "articleBody": "\r\n\u003cscript src=\"/rmarkdown-libs/header-attrs/header-attrs.js\"\u003e\u003c/script\u003e\r\n\u003clink href=\"/rmarkdown-libs/anchor-sections/anchor-sections.css\" rel=\"stylesheet\" /\u003e\r\n\u003cscript src=\"/rmarkdown-libs/anchor-sections/anchor-sections.js\"\u003e\u003c/script\u003e\r\n\r\n\r\n\u003cdiv id=\"linear-regression\" class=\"section level2\"\u003e\r\n\u003ch2\u003eLinear Regression\u003c/h2\u003e\r\n\u003cp\u003eThe easiest and most basic machine learning algorithm is linear regression . It will be the first one that we are going to look at and it is a supervised learning algorithm. That means that we need both – inputs and outputs – to train the model.\u003c/p\u003e\r\n\u003cp\u003eIf we are applying this model to data of schools and we try to find a relation between missing hours, learning time and the resulting grade, we will probably get a less accurate result than by including 30 parameters. Logically, however, we then no longer have a straight line or flat surface but a hyperplane. This is the equivalent to a straight line, in higher dimensions.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\u003cdiv id=\"loading-data\" class=\"section level2\"\u003e\r\n\u003ch2\u003eLoading Data\u003c/h2\u003e\r\n\u003cp\u003eto get started with our code, we first need data that we want to work with. Here we use a dataset from UCI.\u003c/p\u003e\r\n\u003cp\u003eLink: \u003ca href=\"https://archive.ics.uci.edu/ml/datasets/student+performance\" class=\"uri\"\u003ehttps://archive.ics.uci.edu/ml/datasets/student+performance\u003c/a\u003e\u003c/p\u003e\r\n\u003cp\u003eThis is a dataset which contains a lot of information about student performance. We will use it as sample data for our models.\u003c/p\u003e\r\n\u003cp\u003eWe download the ZIP-file from the Data Folder and extract the file student-mat.csv from there into the folder in which we code our script.\u003c/p\u003e\r\n\u003cp\u003eNow we can start with our code. First of all, we will import the necessary libraries.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003eimport numpy as np\r\nimport pandas as pd\r\nimport matplotlib.pyplot as plt\r\nfrom sklearn.linear_model import LinearRegression\r\nfrom sklearn.model_selection import train_test_split\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eBesides the imports of the first three libraries that we already know, we have two more imports that are new to us. First, we import the LinearRegression module . This is the module that we will use for creating, training and using our regression model. Additionally, we import the train_test_split module, which we will use to prepare and split our data.\r\nOur first action is to load the data from the CSV file into a Pandas DataFrame. We do this with the function read_csv.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003edata = pd.read_csv( \u0026#39;../data/student/student-mat.csv\u0026#39; , sep = \u0026#39;;\u0026#39; )\r\nprint(data.tail())\u003c/code\u003e\u003c/pre\u003e\r\n\u003cpre\u003e\u003ccode\u003e##     school sex  age address famsize Pstatus  ...  Walc  health absences  G1  G2  G3\r\n## 390     MS   M   20       U     LE3       A  ...     5       4       11   9   9   9\r\n## 391     MS   M   17       U     LE3       T  ...     4       2        3  14  16  16\r\n## 392     MS   M   21       R     GT3       T  ...     3       3        3  10   8   7\r\n## 393     MS   M   18       R     LE3       T  ...     4       5        0  11  12  10\r\n## 394     MS   M   19       U     LE3       T  ...     3       5        5   8   9   9\r\n## \r\n## [5 rows x 33 columns]\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eIt is important that we change our separator to semicolon, since the default separator for CSV files is a comma and our file is separated by semicolons.\u003c/p\u003e\r\n\u003cp\u003eIn the next step, we think about which features (i.e. columns) are relevant for us, and what exactly we want to predict. A description of all features can be found on the previously mentioned website. In this example, we will limit ourselves to the following columns:\u003c/p\u003e\r\n\u003cp\u003eAge, Sex, Studytime, Absences, G1, G2, G3 (label)\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003edata = data[[ \u0026#39;age\u0026#39; , \u0026#39;sex\u0026#39; , \u0026#39;studytime\u0026#39; ,\u0026#39;absences\u0026#39; , \u0026#39;G1\u0026#39; , \u0026#39;G2\u0026#39; , \u0026#39;G3\u0026#39; ]]\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eThe columns G1, G2 and G3 are the three grades that the students get. Our goal is to predict the\r\nthird and final grade by looking at the other values like first grade, age, sex and so on.\u003c/p\u003e\r\n\u003cp\u003eSummarized that means that we only select these columns from our DataFrame, out of the 33 possible.\u003c/p\u003e\r\n\u003cp\u003eG3 is our label and the rest are our features. Each feature is an axis in the coordinate system and each point is a record, that is, one row in the table.\r\nBut we have a little problem here. The sex feature is not numeric, but stored as F (for female) or M (for male) . But for us to work with it and register it in the coordinate system, we have to convert it into numbers.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003edata[ \u0026#39;sex\u0026#39; ] = data[ \u0026#39;sex\u0026#39; ].map({ \u0026#39;F\u0026#39; : 0 , \u0026#39;M\u0026#39; : 1 })\r\nprediction = \u0026#39;G3\u0026#39; \u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eWe do this by using the map function. Here, we map a dictionary to our feature. Each F becomes a zero and every M becomes a one. Now we can work with it.\r\nFinally, we define the column of the desired label as a variable to make it easier to work with.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\u003cdiv id=\"preparing-data\" class=\"section level2\"\u003e\r\n\u003ch2\u003ePREPARING DATA\u003c/h2\u003e\r\n\u003cp\u003eOur data is now fully loaded and selected. However, in order to use it as training and testing data for our model, we have to reformat them. The sklearn models do not accept Pandas data frames, but only NumPy arrays. That’s why we turn our features into an x-array and our label into a y-array.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003eX = np.array(data.drop([prediction], 1 ))\r\nY = np.array(data[prediction])\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eThe method np.array converts the selected columns into an array. The drop function returns the data frame without the specified column. Our X array now contains all of our columns, except for the final grade. The final grade is in the Y array.\r\nIn order to train and test our model, we have to split our available data. The first part is used to get the hyperplane to fit our data as well as possible. The second part then checks the accuracy of the prediction, with previously unknown data.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003eX_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.1 )\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eWith the function train_test_split , we divide our X and Y arrays into four arrays. The order must be exactly as shown here. The test_size parameter specifies what percentage of records to use for testing. In this case, it is 10%. This is also a good and recommended value. We do this to test how accurate it is with data that our model has never seen before.\u003c/p\u003e\r\n\u003c/div\u003e\r\n\u003cdiv id=\"training-and-testing\" class=\"section level2\"\u003e\r\n\u003ch2\u003eTRAINING AND TESTING\u003c/h2\u003e\r\n\u003cp\u003eNow we can start training and testing our model. For that, we first define our model.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003emodel = LinearRegression()\r\nmodel.fit(X_train, Y_train)\u003c/code\u003e\u003c/pre\u003e\r\n\u003cpre\u003e\u003ccode\u003e## LinearRegression()\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eBy using the constructor of the LinearRegression class, we create our model. We then use the fit function and pass our training data. Now our model is already trained. It has now adjusted its hyperplane so that it fits all of our values.\r\nIn order to test how well our model performs, we can use the score method and pass our testing data.\u003c/p\u003e\r\n\u003cp\u003eaccuracy = model.score(X_test, Y_test)\r\nprint (accuracy)\r\nSince the splitting of training and test data is always random, we will have slightly different results on each run. An average result could look like this:\r\n0.9130676521162756\r\nActually, 91 percent is a pretty high and good accuracy. Now that we know that our model is somewhat reliable, we can enter new data and predict the final grade.\u003c/p\u003e\r\n\u003cpre class=\"python\"\u003e\u003ccode\u003eX_new = np.array([[ 18 , 1 , 3 , 40 , 15 , 16 ]])\r\nY_new = model.predict(X_new)\r\nprint (Y_new)\u003c/code\u003e\u003c/pre\u003e\r\n\u003cpre\u003e\u003ccode\u003e## [17.21890846]\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eHere we define a new NumPy array with values for our features in the right order. Then we use the predict method, to calculate the likely final grade for our inputs.\u003c/p\u003e\r\n\u003cp\u003e[17.12142363]\u003c/p\u003e\r\n\u003cp\u003eIn this case, the final grade would probably be 17.\u003c/p\u003e\r\n\u003c/div\u003e"
}
</script>

  

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-155379268-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>  
</head>
  <body>
    
    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5KFS4C"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
      
    


<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/" class="nav">
        
          Blog
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu menu">
      
        
          
          <a href="/" class="nav link"><i class='fa fa-home'></i> Home</a>
        
      
        
          
          <a href="/about/" class="nav link"><i class='far fa-id-card'></i> About</a>
        
      
        
          
          <a href="/blog/" class="nav link"><i class='far fa-newspaper'></i> Blog</a>
        
      
        
          
          <a href="/categories/" class="nav link"><i class='fas fa-sitemap'></i> Categories</a>
        
      
        
          
          <a href="/contact/" class="nav link"><i class='far fa-envelope'></i> Contact</a>
        
      
      <a href="#share-menu" class="nav link share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
      <a href="#search-input" class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a>
    </menu>
 
    <a href="#search-input" class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
    <a href="#share-menu" class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
    <a href="#lang-menu" class="nav lang-toggle" lang="en">en</a>
    <a href="#site-nav" class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  
  
  <menu id="search" class="menu"><input id="search-input" class="search-input menu"></input><div id="search-results" class="search-results menu">

  </div></menu>
  
  <menu id="lang-menu" class="flyout-menu menu">
  <a href="#" lang="en" class="nav link active">English (en)</a>
  
    
      
    
  
</menu>

  
    <menu id="share-menu" class="flyout-menu menu">
      <h1>Share Post</h1>
      




  
    
    <a href="//twitter.com/share?text=Student%20Grade%20Prediction&amp;url=https%3a%2f%2flaxmikants.github.io%2fblog%2fstudent-grade-prediction%2f" target="_blank" rel="noopener" class="nav share-btn twitter">
        <p>Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flaxmikants.github.io%2fblog%2fstudent-grade-prediction%2f" target="_blank" rel="noopener" class="nav share-btn facebook">
        <p>Facebook</p>
        </a>
  

  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2flaxmikants.github.io%2fblog%2fstudent-grade-prediction%2f&amp;title=Student%20Grade%20Prediction" target="_blank" rel="noopener" class="nav share-btn linkedin">
            <p>LinkedIn</p>
          </a>
  


    </menu>
  
</header>

    <div id="wrapper">
      <section id="site-intro" >
  
  <header>
    <h1>Data Science Posts and Resources</h1>
  </header>
  <main>
    <p>Articles on Data Science</p>
  </main>
  
    <footer>
      <ul class="socnet-icons">
        

        <li><a href="//github.com/laxmikants" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>











<li><a href="//linkedin.com/in/laxmikantsoni09" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>




<li><a href="//facebook.com/laxmikantsoni09" target="_blank" rel="noopener" title="Facebook" class="fab fa-facebook"></a></li>










<li><a href="//twitter.com/laxmikantsoni09" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a></li>













      </ul>
    </footer>
  
</section>



      <main id="site-main">
        
  <article class="post">
    <header>
  <div class="title">
    
      <h2><a href="/blog/student-grade-prediction/">Student Grade Prediction</a></h2>
    
    
      <p>Predicting student grade using Linear Regression</p>
    
  </div>
  <div class="meta">
    <time datetime="2020-03-15 00:00:00 &#43;0000 UTC">March 15, 2020</time>
    <p>Laxmi K Soni</p>
    <p>6-Minute Read</p>
  </div>
</header>

    <div id="socnet-share">
      




  
    
    <a href="//twitter.com/share?text=Student%20Grade%20Prediction&amp;url=https%3a%2f%2flaxmikants.github.io%2fblog%2fstudent-grade-prediction%2f" target="_blank" rel="noopener" class="nav share-btn twitter">
        <p>Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flaxmikants.github.io%2fblog%2fstudent-grade-prediction%2f" target="_blank" rel="noopener" class="nav share-btn facebook">
        <p>Facebook</p>
        </a>
  

  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2flaxmikants.github.io%2fblog%2fstudent-grade-prediction%2f&amp;title=Student%20Grade%20Prediction" target="_blank" rel="noopener" class="nav share-btn linkedin">
            <p>LinkedIn</p>
          </a>
  


    </div>
    <div align = "center">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
        <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-3804322353139756"
         data-ad-slot="3387213493"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
        <script>
            $(document).ready(function(){(adsbygoogle = window.adsbygoogle || []).push({})})
        </script>
    </div>
    <div class="content">
      <a href="/blog/student-grade-prediction/" class="image" style="--bg-image: url('https://laxmikants.github.io/img/main/linear_regression-10.jpg');">
    <img src="https://laxmikants.github.io/img/main/linear_regression-10.jpg" alt="">
  </a>
      
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<div id="linear-regression" class="section level2">
<h2>Linear Regression</h2>
<p>The easiest and most basic machine learning algorithm is linear regression . It will be the first one that we are going to look at and it is a supervised learning algorithm. That means that we need both – inputs and outputs – to train the model.</p>
<p>If we are applying this model to data of schools and we try to find a relation between missing hours, learning time and the resulting grade, we will probably get a less accurate result than by including 30 parameters. Logically, however, we then no longer have a straight line or flat surface but a hyperplane. This is the equivalent to a straight line, in higher dimensions.</p>
</div>
<div id="loading-data" class="section level2">
<h2>Loading Data</h2>
<p>to get started with our code, we first need data that we want to work with. Here we use a dataset from UCI.</p>
<p>Link: <a href="https://archive.ics.uci.edu/ml/datasets/student+performance" class="uri">https://archive.ics.uci.edu/ml/datasets/student+performance</a></p>
<p>This is a dataset which contains a lot of information about student performance. We will use it as sample data for our models.</p>
<p>We download the ZIP-file from the Data Folder and extract the file student-mat.csv from there into the folder in which we code our script.</p>
<p>Now we can start with our code. First of all, we will import the necessary libraries.</p>
<pre class="python"><code>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split</code></pre>
<p>Besides the imports of the first three libraries that we already know, we have two more imports that are new to us. First, we import the LinearRegression module . This is the module that we will use for creating, training and using our regression model. Additionally, we import the train_test_split module, which we will use to prepare and split our data.
Our first action is to load the data from the CSV file into a Pandas DataFrame. We do this with the function read_csv.</p>
<pre class="python"><code>data = pd.read_csv( &#39;../data/student/student-mat.csv&#39; , sep = &#39;;&#39; )
print(data.tail())</code></pre>
<pre><code>##     school sex  age address famsize Pstatus  ...  Walc  health absences  G1  G2  G3
## 390     MS   M   20       U     LE3       A  ...     5       4       11   9   9   9
## 391     MS   M   17       U     LE3       T  ...     4       2        3  14  16  16
## 392     MS   M   21       R     GT3       T  ...     3       3        3  10   8   7
## 393     MS   M   18       R     LE3       T  ...     4       5        0  11  12  10
## 394     MS   M   19       U     LE3       T  ...     3       5        5   8   9   9
## 
## [5 rows x 33 columns]</code></pre>
<p>It is important that we change our separator to semicolon, since the default separator for CSV files is a comma and our file is separated by semicolons.</p>
<p>In the next step, we think about which features (i.e. columns) are relevant for us, and what exactly we want to predict. A description of all features can be found on the previously mentioned website. In this example, we will limit ourselves to the following columns:</p>
<p>Age, Sex, Studytime, Absences, G1, G2, G3 (label)</p>
<pre class="python"><code>data = data[[ &#39;age&#39; , &#39;sex&#39; , &#39;studytime&#39; ,&#39;absences&#39; , &#39;G1&#39; , &#39;G2&#39; , &#39;G3&#39; ]]</code></pre>
<p>The columns G1, G2 and G3 are the three grades that the students get. Our goal is to predict the
third and final grade by looking at the other values like first grade, age, sex and so on.</p>
<p>Summarized that means that we only select these columns from our DataFrame, out of the 33 possible.</p>
<p>G3 is our label and the rest are our features. Each feature is an axis in the coordinate system and each point is a record, that is, one row in the table.
But we have a little problem here. The sex feature is not numeric, but stored as F (for female) or M (for male) . But for us to work with it and register it in the coordinate system, we have to convert it into numbers.</p>
<pre class="python"><code>data[ &#39;sex&#39; ] = data[ &#39;sex&#39; ].map({ &#39;F&#39; : 0 , &#39;M&#39; : 1 })
prediction = &#39;G3&#39; </code></pre>
<p>We do this by using the map function. Here, we map a dictionary to our feature. Each F becomes a zero and every M becomes a one. Now we can work with it.
Finally, we define the column of the desired label as a variable to make it easier to work with.</p>
</div>
<div id="preparing-data" class="section level2">
<h2>PREPARING DATA</h2>
<p>Our data is now fully loaded and selected. However, in order to use it as training and testing data for our model, we have to reformat them. The sklearn models do not accept Pandas data frames, but only NumPy arrays. That’s why we turn our features into an x-array and our label into a y-array.</p>
<pre class="python"><code>X = np.array(data.drop([prediction], 1 ))
Y = np.array(data[prediction])</code></pre>
<p>The method np.array converts the selected columns into an array. The drop function returns the data frame without the specified column. Our X array now contains all of our columns, except for the final grade. The final grade is in the Y array.
In order to train and test our model, we have to split our available data. The first part is used to get the hyperplane to fit our data as well as possible. The second part then checks the accuracy of the prediction, with previously unknown data.</p>
<pre class="python"><code>X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.1 )</code></pre>
<p>With the function train_test_split , we divide our X and Y arrays into four arrays. The order must be exactly as shown here. The test_size parameter specifies what percentage of records to use for testing. In this case, it is 10%. This is also a good and recommended value. We do this to test how accurate it is with data that our model has never seen before.</p>
</div>
<div id="training-and-testing" class="section level2">
<h2>TRAINING AND TESTING</h2>
<p>Now we can start training and testing our model. For that, we first define our model.</p>
<pre class="python"><code>model = LinearRegression()
model.fit(X_train, Y_train)</code></pre>
<pre><code>## LinearRegression()</code></pre>
<p>By using the constructor of the LinearRegression class, we create our model. We then use the fit function and pass our training data. Now our model is already trained. It has now adjusted its hyperplane so that it fits all of our values.
In order to test how well our model performs, we can use the score method and pass our testing data.</p>
<p>accuracy = model.score(X_test, Y_test)
print (accuracy)
Since the splitting of training and test data is always random, we will have slightly different results on each run. An average result could look like this:
0.9130676521162756
Actually, 91 percent is a pretty high and good accuracy. Now that we know that our model is somewhat reliable, we can enter new data and predict the final grade.</p>
<pre class="python"><code>X_new = np.array([[ 18 , 1 , 3 , 40 , 15 , 16 ]])
Y_new = model.predict(X_new)
print (Y_new)</code></pre>
<pre><code>## [17.21890846]</code></pre>
<p>Here we define a new NumPy array with values for our features in the right order. Then we use the predict method, to calculate the likely final grade for our inputs.</p>
<p>[17.12142363]</p>
<p>In this case, the final grade would probably be 17.</p>
</div>

    </div>
    <footer>
      <div class="stats">
  <ul class="categories">
    
      
        
          <li><a class="article-terms-link" href="/categories/linear-regression/">Linear Regression</a></li>
        
      
    
  </ul>
  <ul class="tags">
    
      
        
          <li><a class="article-terms-link" href="/tags/linear-regression/">Linear Regression</a></li>
        
      
    
  </ul>
</div>

    </footer>
  </article>
  
    

  <article class="post">
    
    <div>
      <h2 id="say-something">Say Something</h2>
        <form id="comment-form" class="new-comment" method="POST">
          
          <h3 class='reply-notice hidden'>
            <span class='reply-name'></span>
          </h3>

          
          <input type="hidden" name="options[entryId]" value="4f1144dbda2b2bca22178c76f0ff4a12">
          <input type='hidden' name='fields[replyThread]' value=''>
          <input type='hidden' name='fields[replyID]' value=''>
          <input type='hidden' name='fields[replyName]' value=''>

          
          <input required name='fields[name]' type='text' placeholder='Your Name'>
          <input name='fields[website]' type='text' placeholder='Your Website'>
          <input required name='fields[email]' type='email' placeholder='Your Email'>
          <textarea required name='fields[body]' placeholder='Your Message' rows='10'></textarea>

          
          

          
          <div class='submit-notice'>
            <strong class='submit-notice-text submit-success hidden'>Thanks for your comment! It will be shown on the site once it has been approved.</strong>
            <strong class='submit-notice-text submit-failed hidden'>Sorry, there was an error with your submission. Please make sure all required fields have been completed and try again.</strong>
          </div>

          
          <input type='submit' value='Submit' class='button'>
          <input type='submit' value='Submitted' class='hidden button' disabled>
          <input type='reset' value='Reset' class='button'>
        </form>
    </div>

    
    <div>
      <h2>Comments</h2><p>Nothing yet.</p>
      
    </div>
  </article>


  
  <div class="pagination">
    
      <a href="/blog/classification/" class="button left"><span>Classification</span></a>
    
    
      <a href="/blog/linear-regression/" class="button right"><span>Linear Regression</span></a>
    
  </div>
  

      </main>
      
<section id="site-sidebar">
 
  <div align="center">
      
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-pub-3804322353139756"
           data-ad-slot="9101315425"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           $(document).ready(function(){(adsbygoogle = window.adsbygoogle || []).push({})})
      </script>
  
  </div>

  
    <section id="recent-posts">
      <header>
        <h1>Recent Posts</h1>
      </header>
      
      <article class="mini-post">
          <a href="/blog/convolutional-neural-networks/" class="image" style="--bg-image: url('https://laxmikants.github.io/img/main/cnn-neural-network.jpg');">
    <img src="https://laxmikants.github.io/img/main/cnn-neural-network.jpg" alt="">
  </a>
        <header>
          <h2><a href="/blog/convolutional-neural-networks/">Convolutional Neural Networks</a></h2>
          <time class="published" datetime="2021-01-29 00:00:00 &#43;0000 UTC">January 29, 2021</time>
        </header>
      </article>
      
      <article class="mini-post">
          <a href="/blog/neural-network-using-make-moons-dataset/" class="image" style="--bg-image: url('https://laxmikants.github.io/img/main/nn_makemoons_dataset.jpg');">
    <img src="https://laxmikants.github.io/img/main/nn_makemoons_dataset.jpg" alt="">
  </a>
        <header>
          <h2><a href="/blog/neural-network-using-make-moons-dataset/">Neural Network using Make Moons dataset</a></h2>
          <time class="published" datetime="2020-12-10 00:00:00 &#43;0000 UTC">December 10, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
          <a href="/blog/single-layer-perceptron/" class="image" style="--bg-image: url('https://laxmikants.github.io/img/main/Single_Layer_Perceptron.jpg');">
    <img src="https://laxmikants.github.io/img/main/Single_Layer_Perceptron.jpg" alt="">
  </a>
        <header>
          <h2><a href="/blog/single-layer-perceptron/">Single Layer Perceptron</a></h2>
          <time class="published" datetime="2020-12-10 00:00:00 &#43;0000 UTC">December 10, 2020</time>
        </header>
      </article>
      
      
        <footer>
          <a href="/blog/" class="button">See More</a>
        </footer>
      

      
    </section>
  

  <div align="center">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3804322353139756"
     data-ad-slot="3115024406"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
    <script>
        $(document).ready(function(){(adsbygoogle = window.adsbygoogle || []).push({})})
    </script>
  </div>
  
  
    
      <section id="categories">
        
   
        <header>
          <h1><a href="/categories">Categories</a></h1>
        </header>
        <ul>
          
          
          <li>
              <a href="/categories/python/">python<span class="count">14</span></a>
          
          <li>
              <a href="/categories/linear-regression/">linear-regression<span class="count">2</span></a>
          
          <li>
              <a href="/categories/logistic-regression/">logistic-regression<span class="count">2</span></a>
          
          <li>
              <a href="/categories/big-data/">big-data<span class="count">1</span></a>
          
          <li>
              <a href="/categories/bigdata/">bigdata<span class="count">1</span></a>
          
          <li>
              <a href="/categories/classification/">classification<span class="count">1</span></a>
          
          <li>
              <a href="/categories/clustering/">clustering<span class="count">1</span></a>
          
          <li>
              <a href="/categories/convolutional-neural-networks/">convolutional-neural-networks<span class="count">1</span></a>
          
          <li>
              <a href="/categories/data-science/">data-science<span class="count">1</span></a>
          
          <li>
              <a href="/categories/decision-trees/">decision-trees<span class="count">1</span></a>
          
          <li>
              <a href="/categories/eda/">eda<span class="count">1</span></a>
          
          <li>
              <a href="/categories/exploring-dataset/">exploring-dataset<span class="count">1</span></a>
          
          <li>
              <a href="/categories/frequency-tables/">frequency-tables<span class="count">1</span></a>
          
          <li>
              <a href="/categories/hadoop/">hadoop<span class="count">1</span></a>
          
          <li>
              <a href="/categories/k-nearest-neighbours/">k-nearest-neighbours<span class="count">1</span></a>
          
          <li>
              <a href="/categories/machine-learning/">machine-learning<span class="count">1</span></a>
          
          <li>
              <a href="/categories/natural-language-processing/">natural-language-processing<span class="count">1</span></a>
          
          <li>
              <a href="/categories/neural-network/">neural-network<span class="count">1</span></a>
          
          <li>
              <a href="/categories/neural-networks/">neural-networks<span class="count">1</span></a>
          
          <li>
              <a href="/categories/numeric-data/">numeric-data<span class="count">1</span></a>
          
          <li>
              <a href="/categories/pandas/">pandas<span class="count">1</span></a>
          
          <li>
              <a href="/categories/react-native/">react-native<span class="count">1</span></a>
          
          <li>
              <a href="/categories/reactjs/">reactjs<span class="count">1</span></a>
          
          <li>
              <a href="/categories/single-layer-perceptron/">single-layer-perceptron<span class="count">1</span></a>
          
          <li>
              <a href="/categories/stock-market/">stock-market<span class="count">1</span></a>
          
          <li>
              <a href="/categories/support-vector-machines/">support-vector-machines<span class="count">1</span></a>
          
          <li>
              <a href="/categories/text-analytics/">text-analytics<span class="count">1</span></a>
          
          <li>
              <a href="/categories/time-series/">time-series<span class="count">1</span></a>
          
          <li>
              <a href="/categories/web-scrapping/">web-scrapping<span class="count">1</span></a>
          
          </li>
        </ul>
      </section>
    
  



  
    <section id="mini-bio">
      <header>
        <h1>About</h1>
      </header>
      <p>about</p>
      <footer>
        <a href="/about" class="button">Learn More</a>
      </footer>
    </section>
  
</section>

      <footer id="site-footer">
  
  
      <ul class="socnet-icons">
        

        <li><a href="//github.com/laxmikants" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>











<li><a href="//linkedin.com/in/laxmikantsoni09" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>




<li><a href="//facebook.com/laxmikantsoni09" target="_blank" rel="noopener" title="Facebook" class="fab fa-facebook"></a></li>










<li><a href="//twitter.com/laxmikantsoni09" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a></li>













      </ul>
  
  <p class="copyright">
    © 2021 Data Science Posts and Resources
      <br>
  </p>
</footer>

      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/python.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script><script src="//code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.js"></script>
    <script src="//unpkg.com/lunr/lunr.js"></script><script src="/js/bundlecdn.min.daca826145adfcf5004b4b16d74010eff217a0382fad56b874f5630927a20c4e.js" integrity="sha256-2sqCYUWt/PUAS0sW10AQ7/IXoDgvrVa4dPVjCSeiDE4="></script>
    <script src="/js/add-on.js"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-155379268-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </div>
  </body>
  
</html>
